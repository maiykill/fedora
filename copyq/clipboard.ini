[Command]
Name=Clipboard Persistence (Loop Safe)
Automatic=true
Match=^.+$
MatchClipboard=owner_change
Command="
copyq:
var clipText = str(clipboard())
if (clipText && clipText.length > 0) {
    // If we don't own the clipboard already, copy clipboard content to take ownership
    if (!isClipboardOwned()) {
        copy(clipText)
    }
}

function isClipboardOwned() {
    try {
        // This function checks if CopyQ owns the clipboard
        var owners = clipboardOwners()
        return owners.contains('copyq')
    } catch(e) {
        // Fallback if not available
        return false
    }
}
"
Icon=\xf02e

